/* 
 * CIMA - Sistema de Diseño Base
 * Minimalismo Suizo + Azul Oscuro Corporativo
 */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* === LAYER BASE === */
@layer base {
    /* Tipografía base */
    html {
        @apply scroll-smooth;
    }

    body {
        @apply font-sans text-neutral-900 antialiased;
        @apply bg-white;
    }

    /* Headings con familia display */
    h1, h2, h3, h4, h5, h6 {
        @apply font-display font-semibold text-neutral-900;
    }

    h1 { @apply text-4xl lg:text-5xl; }
    h2 { @apply text-3xl lg:text-4xl; }
    h3 { @apply text-2xl lg:text-3xl; }
    h4 { @apply text-xl lg:text-2xl; }
    h5 { @apply text-lg lg:text-xl; }
    h6 { @apply text-base lg:text-lg; }

    /* Foco global accesible */
    *:focus-visible {
        @apply outline-2 outline-offset-2 outline-navy-500;
    }

    /* Inputs base */
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="number"],
    input[type="search"],
    textarea,
    select {
        @apply cima-input;
    }
}

/* === LAYER COMPONENTS === */
@layer components {
    /* === UTILIDADES DE TEXTO === */
    .cima-text-balance {
        text-wrap: balance;
    }

    .cima-truncate-2 {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
    }

    .cima-truncate-3 {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 3;
        overflow: hidden;
    }

    /* === OVERLAYS Y GRADIENTES === */
    .cima-overlay {
        @apply absolute inset-0 bg-gradient-to-t from-neutral-900/80 via-neutral-900/40 to-transparent;
    }

    .cima-overlay-hover {
        @apply absolute inset-0 bg-navy-900/0 transition-all duration-300;
    }

    .cima-overlay-hover:hover {
        @apply bg-navy-900/10;
    }

    /* === SKELETON LOADERS === */
    .cima-skeleton {
        @apply animate-pulse bg-neutral-200 rounded;
    }

    .cima-skeleton-text {
        @apply h-4 bg-neutral-200 rounded animate-pulse;
    }

    .cima-skeleton-image {
        @apply w-full aspect-video bg-neutral-200 rounded-lg animate-pulse;
    }

    /* === BADGES === */
    .cima-badge {
        @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium;
    }

    .cima-badge-primary {
        @apply bg-navy-100 text-navy-800;
    }

    .cima-badge-success {
        @apply bg-success-light text-success-dark;
    }

    .cima-badge-warning {
        @apply bg-warning-light text-warning-dark;
    }

    .cima-badge-danger {
        @apply bg-danger-light text-danger-dark;
    }

    /* === DIVIDERS === */
    .cima-divider {
        @apply border-t border-neutral-200 my-6;
    }

    .cima-divider-vertical {
        @apply border-l border-neutral-200 mx-4;
    }

    /* === ESTADOS DE CARGA === */
    .cima-loading-spinner {
        @apply inline-block w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin;
    }

    /* === CARDS ESPECIALIZADAS === */
    .cima-card-interactive {
        @apply cima-card cursor-pointer;
        @apply transition-all duration-300 ease-smooth;
        @apply hover:shadow-lg hover:-translate-y-1;
        @apply focus-visible:ring-2 focus-visible:ring-navy-500 focus-visible:ring-offset-2;
    }

    /* Card con flip 3D */
    .cima-card-flip-container {
        perspective: 1000px;
        @apply relative;
    }

    .cima-card-flip {
        @apply relative w-full h-full;
        transition: transform 0.6s;
        transform-style: preserve-3d;
    }

    .cima-card-flip.flipped {
        transform: rotateY(180deg);
    }

    .cima-card-flip-front,
    .cima-card-flip-back {
        @apply absolute w-full h-full;
        backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
    }

    .cima-card-flip-back {
        transform: rotateY(180deg);
    }

    /* === INFO ICON (i) === */
    .cima-info-icon {
        @apply w-8 h-8 flex items-center justify-center;
        @apply bg-neutral-400/80 text-white rounded-full;
        @apply text-sm font-semibold cursor-pointer;
        @apply transition-all duration-200;
        @apply hover:bg-navy-500 hover:scale-110;
        @apply focus-visible:ring-2 focus-visible:ring-navy-500 focus-visible:ring-offset-2;
        /* Área de clic expandida */
        @apply relative;
        padding: 0.75rem; /* Área de interacción más amplia */
    }

    /* === FORMS === */
    .cima-form-group {
        @apply mb-4;
    }

    .cima-label {
        @apply block text-sm font-medium text-neutral-700 mb-1.5;
    }

    .cima-label-required::after {
        content: " *";
        @apply text-danger;
    }

    .cima-error-message {
        @apply mt-1 text-sm text-danger;
    }

    .cima-help-text {
        @apply mt-1 text-sm text-neutral-500;
    }

    /* === TABS === */
    .cima-tabs {
        @apply flex border-b border-neutral-200;
    }

    .cima-tab {
        @apply px-4 py-2 text-sm font-medium text-neutral-600;
        @apply border-b-2 border-transparent;
        @apply hover:text-navy-600 hover:border-neutral-300;
        @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-navy-500;
        @apply transition-colors duration-200;
    }

    .cima-tab-active {
        @apply text-navy-600 border-navy-500;
    }

    /* === TOAST DE ENTORNO === */
    .cima-env-toast {
        @apply fixed bottom-4 right-4 z-50;
        @apply px-4 py-2 rounded-lg shadow-lg;
        @apply text-sm font-medium;
        @apply pointer-events-none;
    }

    .cima-env-toast-develop {
        @apply bg-warning text-warning-dark;
    }

    .cima-env-toast-staging {
        @apply bg-info text-white;
    }

    /* === LAZY LOAD IMAGES === */
    .cima-image-lazy {
        @apply transition-opacity duration-300;
        opacity: 0;
    }

    .cima-image-lazy.loaded {
        opacity: 1;
    }

    /* === RESPONSIVE IMAGES === */
    .cima-responsive-image {
        @apply w-full h-auto object-cover;
    }

    /* === MODO OSCURO (tokens preparados) === */
    .dark {
        .cima-card {
            @apply bg-neutral-800 text-neutral-100;
        }

        .cima-input {
            @apply bg-neutral-800 text-neutral-100 border-neutral-700;
        }

        .cima-btn-secondary {
            @apply bg-neutral-800 text-neutral-100;
        }

        .cima-section-alt {
            @apply bg-neutral-900;
        }

        .cima-overlay {
            @apply from-neutral-900/90 via-neutral-900/60;
        }
    }
}

/* === LAYER UTILITIES === */
@layer utilities {
    /* Animaciones específicas */
    .animate-draw {
        stroke-dasharray: 1000;
        stroke-dashoffset: 1000;
        animation: draw-line 2s ease-out forwards;
    }

    /* Aspect ratios personalizados */
    .aspect-listing-card {
        aspect-ratio: 16 / 10;
    }

    /* Backdrop blur personalizado */
    .backdrop-blur-sm-safari {
        -webkit-backdrop-filter: blur(4px);
        backdrop-filter: blur(4px);
    }
}

/* === ANIMACIONES DE CARGA CAD === */
@keyframes draw-line {
    to {
        stroke-dashoffset: 0;
    }
}

/* === LOADER PRINCIPAL === */
.loader {
    position: fixed;
    top: 0;
    right: 0;
    left: 0;
    bottom: 0;
    width: 100vw;
    height: 100vh;
    z-index: 999;
    background-color: #fafafa;
    display: flex;
    align-items: center;
    justify-content: center;
}

.dark .loader {
    background-color: #0a0a0a;
}

/* Ocultar contenedor de app duplicado durante carga */
#ApplicationContainer > div:first-child:not(:only-child) {
    display: none !important;
}

/* === BLAZOR ERROR UI === */
#blazor-error-ui {
    background: lightyellow;
    bottom: 0;
    box-shadow: 0 -1px 2px rgba(0, 0, 0, 0.2);
    display: none;
    left: 0;
    padding: 0.6rem 1.25rem 0.7rem 1.25rem;
    position: fixed;
    width: 100%;
    z-index: 1000;
}

#blazor-error-ui .dismiss {
    cursor: pointer;
    position: absolute;
    right: 0.75rem;
    top: 0.5rem;
}

/* === PRINT STYLES === */
@media print {
    .cima-no-print {
        display: none !important;
    }
}


@layer components {
    /* === FLUJOS DE AUTENTICACION === */
    .auth-page {
        @apply min-h-screen flex items-center justify-center p-4;
        background: #1d2a4b;
    }

    .auth-container {
        @apply w-full max-w-[420px];
        animation: auth-slide-up 0.5s ease-out;
    }

    .auth-logo {
        @apply text-center mb-10;
    }

    .auth-logo img {
        @apply mx-auto;
        height: 120px;
        width: auto;
        filter: brightness(0) invert(1);
    }

    .auth-card {
        @apply bg-white rounded-2xl p-10 shadow-2xl;
    }

    .auth-card-centered {
        @apply text-center;
    }

    .auth-title {
        @apply text-2xl font-bold text-navy-900 mb-2;
    }

    .auth-subtitle {
        @apply text-sm text-neutral-500 mb-6 leading-relaxed;
    }

    .auth-form-group {
        @apply mb-5 text-left;
    }

    .auth-label {
        @apply block text-sm font-medium text-neutral-700 mb-2;
    }

    .auth-input {
        @apply w-full px-4 py-3 text-base rounded-xl transition-all;
        @apply border-2 border-neutral-200 bg-neutral-50;
    }

    .auth-input:focus {
        @apply outline-none border-navy-800 ring-4 ring-navy-900/10 bg-white;
    }

    .auth-input::placeholder {
        @apply text-neutral-400;
    }

    .auth-password-wrapper {
        @apply relative;
    }

    .auth-password-toggle {
        @apply absolute right-4 top-1/2 -translate-y-1/2 text-neutral-500 transition-colors;
    }

    .auth-password-toggle:hover {
        @apply text-navy-800;
    }

    .auth-options {
        @apply flex items-center justify-between flex-wrap gap-2 mb-6;
    }

    .auth-remember {
        @apply inline-flex items-center gap-2 cursor-pointer text-neutral-600;
    }

    .auth-checkbox {
        width: 1rem;
        height: 1rem;
        accent-color: #1d2a4b;
        cursor: pointer;
    }

    .auth-link {
        @apply text-sm font-medium text-navy-800 hover:underline;
    }

    .auth-link-light {
        @apply text-sm text-white;
        opacity: 0.8;
    }

    .auth-link-light:hover {
        opacity: 1;
    }

    .auth-alert {
        @apply mb-5 flex items-center gap-3 rounded-lg border px-4 py-3 text-sm;
    }

    .auth-alert svg {
        @apply w-5 h-5 shrink-0;
    }

    .auth-alert-error {
        @apply bg-red-50 border-red-200 text-red-800;
    }

    .auth-submit {
        @apply w-full rounded-xl bg-[#1d2a4b] px-4 py-3 text-white font-semibold transition;
    }

    .auth-submit:hover {
        @apply bg-navy-800 -translate-y-0.5 shadow-lg;
    }

    .auth-submit:disabled {
        @apply opacity-70 cursor-not-allowed translate-y-0 shadow-none;
    }

    .auth-back-link {
        @apply mt-6 flex items-center justify-center gap-2 text-sm transition-colors;
        @apply text-white;
        opacity: 0.8;
    }

    .auth-back-link:hover {
        opacity: 1;
    }

    .auth-back-link svg {
        @apply w-4 h-4;
    }

    .auth-icon-circle {
        @apply w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6;
        background: #eff6ff;
    }

    .auth-icon-circle svg {
        @apply w-8 h-8 text-navy-900;
    }

    .auth-icon-success {
        background: #ecfdf5;
    }

    .auth-icon-success svg {
        color: #059669;
    }

    .auth-icon-error {
        background: #fef2f2;
    }

    .auth-icon-error svg {
        color: #dc2626;
    }

    .auth-icon-warning {
        background: #fef3cd;
    }

    .auth-icon-warning svg {
        color: #f59e0b;
    }

    .auth-requirements {
        @apply mb-5 rounded-lg bg-neutral-50 p-4 text-left;
    }

    .auth-req-title {
        @apply mb-2 text-xs font-semibold uppercase text-neutral-700;
    }

    .auth-req-list {
        @apply list-none space-y-2 text-sm text-neutral-600;
    }

    .auth-req-item {
        @apply flex items-center gap-2;
    }

    .auth-req-item svg {
        @apply w-3.5 h-3.5 text-neutral-400;
    }

    .auth-req-valid svg {
        @apply text-green-600;
    }

    .auth-text-muted {
        @apply text-xs text-neutral-400;
    }

    .auth-text-link {
        @apply text-sm text-navy-800 underline;
    }

    .auth-user-info {
        @apply mb-6 flex items-center justify-center gap-3 rounded-xl bg-neutral-50 p-4;
    }

    .auth-user-avatar {
        @apply flex h-10 w-10 items-center justify-center rounded-full bg-[#1d2a4b] text-sm font-semibold text-white;
    }

    .auth-user-details {
        @apply text-left;
    }

    .auth-user-name {
        @apply text-sm font-semibold text-navy-900;
    }

    .auth-user-email {
        @apply text-xs text-neutral-500;
    }

    .auth-buttons {
        @apply flex flex-col gap-3;
    }

    .auth-btn {
        @apply inline-flex w-full items-center justify-center gap-2 rounded-xl px-4 py-3 text-base font-semibold transition;
    }

    .auth-btn svg {
        @apply w-5 h-5;
    }

    .auth-btn-primary {
        @apply bg-[#1d2a4b] text-white hover:bg-navy-800;
    }

    .auth-btn-secondary {
        @apply bg-white text-navy-900 border-2 border-neutral-200 hover:bg-neutral-50;
    }

    .auth-btn-danger {
        @apply bg-red-600 text-white hover:bg-red-700;
    }

    .auth-note {
        @apply mt-4 border-t border-neutral-200 pt-4 text-xs text-neutral-400;
    }

    .auth-link-inline {
        @apply text-navy-800 underline;
    }

    .auth-loading {
        @apply inline-flex items-center gap-2;
    }

    .auth-spinner {
        animation: auth-spin 1s linear infinite;
    }
}

/* === ANIMACIONES DE AUTENTICACION === */
@keyframes auth-slide-up {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes auth-spin {
    to {
        transform: rotate(360deg);
    }
}
