@using Microsoft.Extensions.Localization
@using cima.Localization
@using cima.Domain.Shared
@inject IStringLocalizer<cimaResource> Localizer
@inject NavigationManager Navigation
@inject IJSRuntime JS

@inherits cimaComponentBase

<section class="relative bg-gradient-to-br from-navy-700 via-navy-600 to-navy-500 text-white overflow-hidden">
    @* Patrón decorativo de fondo *@
    <div class="absolute inset-0 opacity-10">
        <svg class="w-full h-full" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <pattern id="hero-grid" width="40" height="40" patternUnits="userSpaceOnUse">
                    <path d="M 40 0 L 0 0 0 40" fill="none" stroke="currentColor" stroke-width="0.5"/>
                </pattern>
            </defs>
            <rect width="100%" height="100%" fill="url(#hero-grid)" />
        </svg>
    </div>

    <div class="cima-container relative z-10 py-20 md:py-32">
        <div class="max-w-4xl mx-auto text-center">
            @* Título principal *@
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-display font-bold mb-6 cima-text-balance">
                @Localizer["Hero:Title"]
            </h1>
            
            <p class="text-lg md:text-xl text-navy-100 mb-12 max-w-2xl mx-auto">
                @Localizer["Hero:Subtitle"]
            </p>

            @* Card de búsqueda sin sombra *@
            <div class="bg-white rounded-xl p-6 md:p-8 max-w-2xl mx-auto">
                <form @onsubmit="HandleSubmit" @onsubmit:preventDefault class="flex flex-col md:flex-row gap-4">
                    <div class="flex-1">
                        <label for="hero-search" class="sr-only">@Localizer["Hero:SearchPlaceholder"]</label>
                        <input
                            id="hero-search"
                            type="search"
                            class="cima-input"
                            placeholder="@Localizer["Hero:SearchPlaceholder"]"
                            @bind="SearchTerm"
                            @bind:event="oninput"
                            aria-label="@Localizer["Hero:SearchPlaceholder"]" />
                    </div>
                    
                    <button 
                        type="submit" 
                        class="cima-btn cima-btn-primary md:px-8">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                        @Localizer["Hero:SearchButton"]
                    </button>
                </form>

                @* Quick stats o información adicional *@
                <div class="mt-6 pt-6 border-t border-neutral-200 grid grid-cols-3 gap-4 text-center text-sm">
                    <div>
                        <div class="font-semibold text-navy-600 text-lg">500+</div>
                        <div class="text-neutral-600">@Localizer["Properties:Title"]</div>
                    </div>
                    <div>
                        <div class="font-semibold text-navy-600 text-lg">50+</div>
                        <div class="text-neutral-600">@Localizer["Menu:Architects"]</div>
                    </div>
                    <div>
                        <div class="font-semibold text-navy-600 text-lg">1000+</div>
                        <div class="text-neutral-600">@Localizer["Portfolio:CompletedProjects"]</div>
                    </div>
                </div>
            </div>

            @* Indicador de scroll *@
            <button 
                @onclick="ScrollToProperties"
                class="mt-12 inline-flex flex-col items-center text-white/80 hover:text-white transition-colors group"
                aria-label="@Localizer["Hero:ScrollToProperties"]">
                <span class="text-sm mb-2">@Localizer["Hero:ScrollToProperties"]</span>
                <svg class="w-6 h-6 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                </svg>
            </button>
        </div>
    </div>
</section>

@code {
    [Parameter]
    public EventCallback<string> OnSearch { get; set; }

    private string SearchTerm { get; set; } = string.Empty;

    private async Task HandleSubmit()
    {
        if (!string.IsNullOrWhiteSpace(SearchTerm) && OnSearch.HasDelegate)
        {
            await OnSearch.InvokeAsync(SearchTerm.Trim());
        }
    }

    private async Task ScrollToProperties()
    {
        try
        {
            // Scroll suave a la sección de propiedades destacadas usando el ID
            await JS.InvokeVoidAsync("eval", @"
                const featuredSection = document.getElementById('featured-properties');
                if (featuredSection) {
                    featuredSection.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                }
            ");
        }
        catch (Exception)
        {
            // Fallback silencioso si falla el scroll
        }
    }
}
