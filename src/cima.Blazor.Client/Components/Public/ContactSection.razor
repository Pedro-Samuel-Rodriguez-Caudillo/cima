@using cima.Blazor.Client.Components.Common
@using cima.Settings
@inherits cimaComponentBase
@inject ISiteSettingsAppService SettingsService

<section id="contact" class="bg-white py-20 md:py-28">
    <div class="cima-container max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="text-center mb-16">
            <h2 class="text-4xl md:text-5xl font-display font-bold text-navy-900 mb-4 tracking-tight">
                @L["Contact:Title"]
            </h2>
            <p class="text-lg md:text-xl text-neutral-600 font-light">
                @L["Contact:HomeSubtitle"]
            </p>
            
            @* Opción r�pida de WhatsApp *@
            <div class="mt-6 flex flex-col sm:flex-row items-center justify-center gap-4">
                <div class="flex flex-wrap items-center gap-2 justify-center text-neutral-500 text-sm">
                    <span>¿Prefieres contacto directo?</span>
                    @if (ShowWhatsAppConnector)
                    {
                        <span>@L["Contact:DirectContactConnector"]</span>
                    }
                </div>
                <WhatsAppButton 
                    ButtonText="Escríbenos por WhatsApp"
                    ButtonClass="bg-green-500 hover:bg-green-600 text-white px-5 py-2.5 rounded-full font-medium shadow-lg hover:shadow-xl transition-all duration-300"
                    ConfirmButtonClass="bg-green-600 text-white px-5 py-2.5 rounded-full font-medium shadow-lg animate-pulse" />
            </div>
        </div>

        <!-- Form -->
        <GeneralContactForm />
    </div>
</section>

@code {
    private bool ShowWhatsAppConnector;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        await LoadWhatsAppAvailabilityAsync();
    }

    private async Task LoadWhatsAppAvailabilityAsync()
    {
        try
        {
            var settings = await SettingsService.GetPublicAsync();
            ShowWhatsAppConnector = settings.WhatsAppEnabled && !string.IsNullOrEmpty(settings.WhatsAppUrl);
        }
        catch
        {
            ShowWhatsAppConnector = false;
        }
    }
}
