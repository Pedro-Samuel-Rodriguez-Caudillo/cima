@inherits LayoutComponentBase
@using cima.Blazor.Client.Components.Common
@using cima.Blazor.Client.Components.Auth
@using MudBlazor
@inject NavigationManager Navigation
@inject AuthenticationStateProvider AuthenticationStateProvider

<MudThemeProvider />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MustChangePasswordGuard>
    <div class="flex flex-col min-h-screen bg-gray-50">
        <header class="sticky top-0 z-40 w-full">
            <Navbar />
        </header>

        <main class="flex-grow">
            @Body
        </main>

        <Footer />
    </div>
</MustChangePasswordGuard>

<EnvironmentToast />

@code {
    // Removida la lógica de redirección en OnParametersSetAsync
    // La autorización se maneja correctamente por el atributo [Authorize] 
    // en las páginas y por AuthorizeRouteView en Routes.razor
}
