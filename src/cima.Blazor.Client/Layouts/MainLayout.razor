@inherits LayoutComponentBase
@using cima.Blazor.Client.Components.Common
@using cima.Blazor.Client.Components.Auth
@using MudBlazor
@inject NavigationManager Navigation
@inject AuthenticationStateProvider AuthenticationStateProvider

<MudThemeProvider Theme="@_cimaTheme" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MustChangePasswordGuard>
    <div class="flex flex-col min-h-screen bg-gray-50">
        <header class="sticky top-0 z-40 w-full">
            <Navbar />
        </header>

        <main id="main-content" class="flex-grow" tabindex="-1">
            <PageTransition>
                @Body
            </PageTransition>
        </main>

        <Footer />
    </div>
</MustChangePasswordGuard>

<EnvironmentToast />

@code {
    // La autorización se maneja por el atributo [Authorize] 
    // en las páginas y por AuthorizeRouteView en Routes.razor
    private readonly MudTheme _cimaTheme = new()
    {
        PaletteLight = new PaletteLight
        {
            Primary = "#1e3a8a",
            Secondary = "#3f51c5",
            Info = "#0ea5e9",
            Success = "#22c55e",
            Warning = "#f59e0b",
            Error = "#dc2626",
            Background = "#f8f9fa",
            Surface = "#ffffff",
            AppbarBackground = "#1e3a8a",
            DrawerBackground = "#15255a",
            TextPrimary = "#0f172a",
            TextSecondary = "#475569",
        },
        LayoutProperties = new LayoutProperties
        {
            DefaultBorderRadius = "10px",
        },
    };
}
