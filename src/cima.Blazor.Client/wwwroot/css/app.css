@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom Base Styles */
@layer base {
    html {
        scroll-behavior: smooth;
    }

    body {
        @apply font-sans text-neutral-900 antialiased bg-white;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        @apply font-display tracking-tight;
    }
}

/* ========================================
   MICRO-INTERACTIONS - FASE 1: Botones y Controles
   ======================================== */

@layer components {
    /* Primary Button con micro-interacciones */
    .cima-btn {
        @apply inline-flex items-center justify-center px-6 py-3 
               font-medium rounded-lg transition-all duration-200 ease-out
               focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2;
        transform: translateY(0);
    }

    .cima-btn:hover {
        transform: translateY(-2px);
    }

    .cima-btn:active {
        transform: translateY(0) scale(0.98);
        transition-duration: 0.1s;
    }

    .cima-btn-primary {
        @apply bg-navy-600 text-white shadow-md
               hover:bg-navy-700 hover:shadow-lg
               focus-visible:ring-navy-500
               active:bg-navy-800;
    }

    .cima-btn-secondary {
        @apply bg-white text-navy-600 border-2 border-navy-600
               hover:bg-navy-50 hover:shadow-md
               focus-visible:ring-navy-500
               active:bg-navy-100;
    }

    .cima-btn-ghost {
        @apply bg-transparent text-navy-600
               hover:bg-navy-50
               focus-visible:ring-navy-500
               active:bg-navy-100;
    }

    .cima-btn-danger {
        @apply bg-red-600 text-white shadow-md
               hover:bg-red-700 hover:shadow-lg
               focus-visible:ring-red-500
               active:bg-red-800;
    }

    /* Button loading state */
    .cima-btn-loading {
        @apply relative pointer-events-none;
    }

    .cima-btn-loading::after {
        content: '';
        @apply absolute inset-0 flex items-center justify-center;
        background: inherit;
        border-radius: inherit;
    }

    .cima-btn-loading .btn-text {
        @apply opacity-0;
    }

    .cima-btn-loading .btn-spinner {
        @apply absolute;
    }

    /* Icon buttons con rotación/bounce */
    .cima-icon-btn {
        @apply p-2 rounded-lg transition-all duration-200 ease-out
               hover:bg-gray-100 active:scale-90
               focus:outline-none focus-visible:ring-2 focus-visible:ring-navy-500;
    }

    .cima-icon-btn:hover svg {
        transform: scale(1.1);
    }

    .cima-icon-btn-rotate:hover svg {
        transform: rotate(90deg);
    }

    .cima-icon-btn-bounce:hover svg {
        animation: icon-bounce 0.4s ease-out;
    }

    @keyframes icon-bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-3px); }
    }

    /* Inputs con animación de focus */
    .cima-input {
        @apply w-full px-4 py-3 border border-gray-300 rounded-lg
               transition-all duration-200 ease-out
               placeholder:text-gray-400
               focus:outline-none focus:border-navy-500 focus:ring-2 focus:ring-navy-500/20
               hover:border-gray-400;
    }

    .cima-input:focus {
        box-shadow: 0 0 0 3px rgba(29, 42, 75, 0.1);
    }

    /* Input con label flotante */
    .cima-input-group {
        @apply relative;
    }

    .cima-input-group .cima-input {
        @apply pt-6 pb-2;
    }

    .cima-input-group .cima-label {
        @apply absolute left-4 top-1/2 -translate-y-1/2 
               text-gray-500 transition-all duration-200 ease-out
               pointer-events-none;
    }

    .cima-input-group .cima-input:focus ~ .cima-label,
    .cima-input-group .cima-input:not(:placeholder-shown) ~ .cima-label {
        @apply text-xs top-3 text-navy-600;
    }

    /* Checkbox animado */
    .cima-checkbox {
        @apply relative w-5 h-5 appearance-none border-2 border-gray-300 rounded
               transition-all duration-200 ease-out cursor-pointer
               checked:bg-navy-600 checked:border-navy-600
               focus:outline-none focus-visible:ring-2 focus-visible:ring-navy-500 focus-visible:ring-offset-2
               hover:border-navy-400;
    }

    .cima-checkbox:checked {
        background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
        animation: checkbox-pop 0.2s ease-out;
    }

    @keyframes checkbox-pop {
        0% { transform: scale(0.8); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }

    /* Toggle switch */
    .cima-toggle {
        @apply relative w-11 h-6 bg-gray-300 rounded-full cursor-pointer
               transition-colors duration-200 ease-out
               focus:outline-none focus-visible:ring-2 focus-visible:ring-navy-500 focus-visible:ring-offset-2;
    }

    .cima-toggle::after {
        content: '';
        @apply absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow
               transition-transform duration-200 ease-out;
    }

    .cima-toggle:checked {
        @apply bg-navy-600;
    }

    .cima-toggle:checked::after {
        transform: translateX(100%);
    }

    /* Select dropdown */
    .cima-select {
        @apply w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg
               appearance-none bg-white cursor-pointer
               transition-all duration-200 ease-out
               focus:outline-none focus:border-navy-500 focus:ring-2 focus:ring-navy-500/20
               hover:border-gray-400;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.75rem center;
        background-repeat: no-repeat;
        background-size: 1.25rem;
    }
}

/* ========================================
   MICRO-INTERACTIONS - FASE 2: Cards y Listas
   ======================================== */

@layer components {
    /* Property Card con hover effects */
    .cima-card {
        @apply bg-white rounded-xl overflow-hidden
               transition-all duration-300 ease-out;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .cima-card:hover {
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12);
        transform: translateY(-4px);
    }

    .cima-card:active {
        transform: translateY(-2px);
        transition-duration: 0.1s;
    }

    /* Card con imagen zoom al hover */
    .cima-card-image {
        @apply overflow-hidden;
    }

    .cima-card-image img {
        @apply w-full h-full object-cover transition-transform duration-500 ease-out;
    }

    .cima-card:hover .cima-card-image img {
        transform: scale(1.05);
    }

    /* Card sin elevación (flat) */
    .cima-card-flat {
        @apply bg-white rounded-xl border border-gray-200
               transition-all duration-200 ease-out;
    }

    .cima-card-flat:hover {
        @apply border-gray-300 bg-gray-50;
    }

    /* Card interactiva (clickeable) */
    .cima-card-interactive {
        @apply cursor-pointer;
    }

    .cima-card-interactive:focus-visible {
        @apply outline-none ring-2 ring-navy-500 ring-offset-2;
    }

    /* Table row con hover */
    .cima-table-row {
        @apply transition-colors duration-150 ease-out;
    }

    .cima-table-row:hover {
        @apply bg-gray-50;
    }

    .cima-table-row-selected {
        @apply bg-navy-50;
    }

    .cima-table-row-selected:hover {
        @apply bg-navy-100;
    }

    /* List item con hover slide */
    .cima-list-item {
        @apply relative px-4 py-3 transition-all duration-200 ease-out
               border-l-4 border-transparent;
    }

    .cima-list-item:hover {
        @apply bg-gray-50 border-l-navy-500;
        padding-left: 1.25rem;
    }

    .cima-list-item-active {
        @apply bg-navy-50 border-l-navy-600;
    }

    /* Badge/Chip con pulse al crear */
    .cima-badge {
        @apply inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
               transition-all duration-200 ease-out;
    }

    .cima-badge-success {
        @apply bg-green-100 text-green-800;
    }

    .cima-badge-warning {
        @apply bg-yellow-100 text-yellow-800;
    }

    .cima-badge-error {
        @apply bg-red-100 text-red-800;
    }

    .cima-badge-info {
        @apply bg-blue-100 text-blue-800;
    }

    .cima-badge-neutral {
        @apply bg-gray-100 text-gray-800;
    }

    .cima-badge-new {
        animation: badge-pulse 2s ease-in-out 3;
    }

    @keyframes badge-pulse {
        0%, 100% { 
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(29, 42, 75, 0.4);
        }
        50% { 
            transform: scale(1.05);
            box-shadow: 0 0 0 8px rgba(29, 42, 75, 0);
        }
    }

    /* Dropdown menu con slide */
    .cima-dropdown {
        @apply absolute z-50 mt-2 bg-white rounded-lg shadow-lg border border-gray-100
               opacity-0 invisible transform -translate-y-2
               transition-all duration-200 ease-out;
    }

    .cima-dropdown-open {
        @apply opacity-100 visible translate-y-0;
    }

    .cima-dropdown-item {
        @apply px-4 py-2 text-gray-700 transition-colors duration-150
               hover:bg-gray-50 hover:text-navy-600
               first:rounded-t-lg last:rounded-b-lg;
    }

    /* Accordion/Collapsible */
    .cima-accordion-content {
        @apply overflow-hidden transition-all duration-300 ease-out;
        max-height: 0;
    }

    .cima-accordion-open .cima-accordion-content {
        max-height: 500px;
    }

    .cima-accordion-icon {
        @apply transition-transform duration-200 ease-out;
    }

    .cima-accordion-open .cima-accordion-icon {
        transform: rotate(180deg);
    }

    /* Tab indicator slide */
    .cima-tabs {
        @apply relative flex border-b border-gray-200;
    }

    .cima-tab {
        @apply px-4 py-3 text-gray-600 font-medium
               transition-colors duration-200 ease-out
               hover:text-navy-600;
    }

    .cima-tab-active {
        @apply text-navy-600;
    }

    .cima-tab-indicator {
        @apply absolute bottom-0 h-0.5 bg-navy-600
               transition-all duration-300 ease-out;
    }

    /* Empty state */
    .cima-empty-state {
        @apply flex flex-col items-center justify-center py-16 text-center;
    }

    .cima-empty-state-icon {
        @apply w-16 h-16 text-gray-300 mb-4;
    }

    /* Avatar con online indicator */
    .cima-avatar {
        @apply relative inline-block rounded-full overflow-hidden;
    }

    .cima-avatar-online::after {
        content: '';
        @apply absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full
               border-2 border-white;
        animation: online-pulse 2s ease-in-out infinite;
    }

    @keyframes online-pulse {
        0%, 100% { 
            box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4);
        }
        50% { 
            box-shadow: 0 0 0 4px rgba(34, 197, 94, 0);
        }
    }

    /* Progress bar animated */
    .cima-progress {
        @apply h-2 bg-gray-200 rounded-full overflow-hidden;
    }

    .cima-progress-bar {
        @apply h-full bg-navy-600 rounded-full transition-all duration-500 ease-out;
    }

    .cima-progress-bar-animated {
        background: linear-gradient(
            90deg,
            rgba(29, 42, 75, 1) 0%,
            rgba(29, 42, 75, 0.7) 50%,
            rgba(29, 42, 75, 1) 100%
        );
        background-size: 200% 100%;
        animation: progress-shimmer 1.5s ease-in-out infinite;
    }

    @keyframes progress-shimmer {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }

    /* Notification dot */
    .cima-notification-dot {
        @apply absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full;
        animation: notification-bounce 0.5s ease-out;
    }

    @keyframes notification-bounce {
        0% { transform: scale(0); }
        50% { transform: scale(1.3); }
        100% { transform: scale(1); }
    }

    /* Floating Action Button */
    .cima-fab {
        @apply fixed bottom-6 right-6 w-14 h-14 rounded-full
               bg-navy-600 text-white shadow-lg
               flex items-center justify-center
               transition-all duration-300 ease-out
               hover:bg-navy-700 hover:shadow-xl hover:scale-110
               active:scale-95
               focus:outline-none focus-visible:ring-2 focus-visible:ring-navy-500 focus-visible:ring-offset-2
               z-40;
    }

    .cima-fab-hidden {
        @apply opacity-0 translate-y-4 pointer-events-none;
    }
}

/* Page Transition Animations */
@layer utilities {
    /* Fade in animation */
    @keyframes fade-in {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-fade-in {
        animation: fade-in 1s ease-out forwards;
    }

    /* Page transitions */
    .page-transition {
        transition: opacity 0.15s ease-out, transform 0.15s ease-out;
    }

    .page-enter {
        animation: page-enter 0.3s ease-out forwards;
    }

    .page-exit {
        animation: page-exit 0.15s ease-out forwards;
    }

    @keyframes page-enter {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes page-exit {
        from {
            opacity: 1;
            transform: translateY(0);
        }
        to {
            opacity: 0;
            transform: translateY(-10px);
        }
    }

    /* Skeleton pulse animation */
    @keyframes skeleton-pulse {
        0%, 100% {
            opacity: 1;
        }
        50% {
            opacity: 0.5;
        }
    }

    .animate-pulse {
        animation: skeleton-pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    /* Slide in from bottom */
    @keyframes slide-up {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-slide-up {
        animation: slide-up 0.4s ease-out forwards;
    }

    /* Slide in from left */
    @keyframes slide-in-left {
        from {
            opacity: 0;
            transform: translateX(-20px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .animate-slide-in-left {
        animation: slide-in-left 0.3s ease-out forwards;
    }

    /* Slide in from right */
    @keyframes slide-in-right {
        from {
            opacity: 0;
            transform: translateX(20px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .animate-slide-in-right {
        animation: slide-in-right 0.3s ease-out forwards;
    }

    /* Scale in */
    @keyframes scale-in {
        from {
            opacity: 0;
            transform: scale(0.95);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    .animate-scale-in {
        animation: scale-in 0.2s ease-out forwards;
    }

    /* Spinner animation */
    @keyframes spin {
        to {
            transform: rotate(360deg);
        }
    }

    .animate-spin {
        animation: spin 1s linear infinite;
    }

    /* Shake animation (for errors) */
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
        20%, 40%, 60%, 80% { transform: translateX(4px); }
    }

    .animate-shake {
        animation: shake 0.5s ease-out;
    }

    /* Success checkmark animation */
    @keyframes checkmark-draw {
        0% {
            stroke-dashoffset: 50;
        }
        100% {
            stroke-dashoffset: 0;
        }
    }

    .animate-checkmark path {
        stroke-dasharray: 50;
        stroke-dashoffset: 50;
        animation: checkmark-draw 0.3s ease-out 0.1s forwards;
    }

    /* Staggered children animation */
    .stagger-children > * {
        opacity: 0;
        animation: slide-up 0.4s ease-out forwards;
    }

    .stagger-children > *:nth-child(1) { animation-delay: 0.05s; }
    .stagger-children > *:nth-child(2) { animation-delay: 0.1s; }
    .stagger-children > *:nth-child(3) { animation-delay: 0.15s; }
    .stagger-children > *:nth-child(4) { animation-delay: 0.2s; }
    .stagger-children > *:nth-child(5) { animation-delay: 0.25s; }
    .stagger-children > *:nth-child(6) { animation-delay: 0.3s; }
    .stagger-children > *:nth-child(7) { animation-delay: 0.35s; }
    .stagger-children > *:nth-child(8) { animation-delay: 0.4s; }
    .stagger-children > *:nth-child(9) { animation-delay: 0.45s; }
    .stagger-children > *:nth-child(10) { animation-delay: 0.5s; }
    .stagger-children > *:nth-child(11) { animation-delay: 0.55s; }
    .stagger-children > *:nth-child(12) { animation-delay: 0.6s; }
}

/* Focus visible styles for accessibility */
@layer utilities {
    .focus-ring {
        @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-navy-500 focus-visible:ring-offset-2;
    }

    /* Skip link for keyboard navigation */
    .skip-link {
        @apply sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 
               focus:px-4 focus:py-2 focus:bg-navy-600 focus:text-white focus:rounded-lg;
    }
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
    .page-transition,
    .animate-fade-in,
    .animate-slide-up,
    .animate-slide-in-left,
    .animate-slide-in-right,
    .animate-scale-in,
    .animate-shake,
    .stagger-children > *,
    .cima-btn,
    .cima-checkbox:checked,
    .cima-toggle::after,
    .cima-card,
    .cima-card-image img,
    .cima-dropdown,
    .cima-accordion-content,
    .cima-tab-indicator,
    .cima-fab,
    .cima-progress-bar {
        animation: none !important;
        transition: none !important;
    }

    .animate-pulse,
    .cima-badge-new,
    .cima-avatar-online::after,
    .cima-progress-bar-animated {
        animation: none !important;
    }

    .cima-btn:hover,
    .cima-btn:active,
    .cima-card:hover {
        transform: none !important;
    }
}